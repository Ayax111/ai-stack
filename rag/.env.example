mkdir -p rag infra rag/data .github/workflows

cat > rag/.env.example <<'ENV'
# ---- LLM (LM Studio) ----
LLM_BASE_URL=http://192.168.0.194:1234/v1
LLM_API_KEY=changeme-lmstudio
LLM_MODEL=llama-3.2-3b-instruct-uncensored

# ---- Postgres (primero PG*, luego DATABASE_URL) ----
PGHOST=localhost
PGPORT=5432
PGUSER=postgres
PGPASSWORD=changeme
PGDATABASE=ragdb
DATABASE_URL=postgresql+psycopg://${PGUSER}:${PGPASSWORD}@${PGHOST}:${PGPORT}/${PGDATABASE}

# ---- Documentos ----
DATA_DIR=./data
CHUNK_SIZE=800
CHUNK_OVERLAP=120

# ---- Embeddings (elige uno) ----
# Opción A: LM Studio
EMBEDDING_BACKEND=lmstudio
EMBEDDING_BASE_URL=http://192.168.0.194:1234/v1
EMBEDDING_API_KEY=${LLM_API_KEY}
EMBEDDING_MODEL=text-embedding-embeddinggemma-300m
# EMBEDDING_ENDPOINT=embeddings
# EMBEDDING_DIM=768

# Opción B: sentence-transformers
# EMBEDDING_BACKEND=sentence-transformers
# EMBEDDING_MODEL=BAAI/bge-m3

# ---- Retrieve / control ----
TOP_K=5
SCORE_THRESHOLD=0.25
MAX_CONTEXT_CHARS=4000
MAX_CHUNKS_PER_DOC=2
ROUND_ROBIN_PER_DOC=1
DEBUG_RETRIEVE=0

# ---- Reranker (opcional) ----
RERANKER_ENABLED=0
RERANKER_CANDIDATES=20
ENV
